---
layout: post
title:  "Golang"
author: wangbin
categories: [ 编程语言, Golang ]
image: assets/images/16.jpg
---

# 1、Go 语言简介
- Go 语言起源 2007 年，并于 2009 年正式对外发布
- Go 语言三位作者：
    - `Robert Griesemer`，参与开发 Java HotSpot 虚拟机；
    - `Rob Pike`，Go 语言项目总负责人，贝尔实验室 Unix 团队成员，参与的项目包括 Plan 9，Inferno 操作系统和 Limbo 编程语言；
    - `Ken Thompson`，贝尔实验室 Unix 团队成员，C 语言、Unix 和 Plan 9 的创始人之一，与 Rob Pike 共同开发了 UTF-8 字符集规范
- 为什么要创造一门编程语言：
    - C/C++ 的发展速度无法跟上计算机发展的脚步，十多年来也没有出现一门与时代相符的主流系统编程语言，因此人们需要一门新的系统编程语言来弥补这个空缺，尤其是在计算机信息时代。
    - 相比计算机性能的提升，软件开发领域不被认为发展得足够快或者比硬件发展得更加成功（有许多项目均以失败告终），同时应用程序的体积始终在不断地扩大，这就迫切地需要一门具备更高层次概念的低级语言来突破现状。
    - 在 Go 语言出现之前，开发者们总是面临非常艰难的抉择，究竟是使用执行速度快但是编译速度并不理想的语言（如：C++），还是使用编译速度较快但执行效率不佳的语言（如：.NET、Java），或者说开发难度较低但执行速度一般的动态语言呢？显然，Go 语言在这 3 个条件之间做到了最佳的平衡：==快速编译，高效执行，易于开发==。
- Hello World

```go
package main    // Go 程序都组织成包

import "fmt"    // import 语句用于导入外部代码。标准库中的 fmt 包用于格式化并输出数据

func main() {   // 像 C 语言一样，main 函数是程序执行的入口
    fmt.Println("Hello World!")
}
```

# 2、基本结构与数据类型
## 2.1 文件名、关键字、标识符
- 文件后缀名为 `.go`，由小写字母组成，如果有多个部分，用 `_` 分隔，如 `fmt_test.go`
- go语言关键字只有25个：`break, default, func, interface, select, case, defer, go, map, struct, chan, else, goto, package, switch, const, fallthrough, if, range, type, continue, for, import, return, var`
- 还有 36 个预定义标识符：`append, bool, byte, cap, close, complex, complex64, complex128, uint16, copy, false, float32, float64, imag, int, int8, int16, uint32, int32, int64, iota, len, make, new, nil, panic, uint64, print, println, real, recover, string, true, uint, uint8, uintptr`
- 有效的标识符必须以字母（可以使用任何 UTF-8 编码的字符或 \_）开头，然后紧跟着 0 个或多个字符或 Unicode 数字，如：`X56`、`group1`、`_x23`、`i`、`өԑ12`。

## 2.2 包的概念、导入与可见性
- 如同其它一些编程语言中的类库或命名空间的概念，每个 Go 文件都属于且仅属于一个包。一个包可以由许多以 .go 为扩展名的源文件组成，因此文件名和包名一般来说都是不相同的。
- 必须在源文件中非注释的第一行指明这个文件属于哪个包，如：package main。package main表示一个可独立执行的程序，每个 Go 应用程序都包含一个名为 main 的包。
- 如果对一个包进行更改或重新编译，所有引用了这个包的程序都必须全部重新编译。
- 导入包的方式：

```go
import "fmt"
import "os"
```

```go
import (
   "fmt"
   "os"
)
```

- 可见性规则：
    - 当标识符（包括常量、变量、类型、函数名、结构字段等等）以一个大写字母开头，如：Group1，那么使用这种形式的标识符的对象就可以被外部包的代码所使用（客户端程序需要先导入这个包），这被称为导出（像面向对象语言中的 public）
    - 标识符如果以小写字母开头，则对包外是不可见的，但是他们在整个包的内部是可见并且可用的（像面向对象语言中的 private ）。
- 可以通过使用包的别名来解决包名之间的名称冲突，如：`import fm "fmt"`
- 如果导入了一个包却没有使用它，则在编译时会报错，如：`"os" imported but not used`

## 2.3 注释
- 使用和 C 语言一样的注释方式，`//` 表示单行注释，`/**/` 表示多行注释或块注释

## 2.4 类型与运算符
- Go 语言类型包括：`int、float32、 float64、bool、string、struct、array、slice、map、channel、interface。`

```go
与操作系统架构无关的类型都有固定的大小，并在类型的名称中就可以看出来：
整数：
int8（-128 -> 127）
int16（-32768 -> 32767）
int32（-2,147,483,648 -> 2,147,483,647）
int64（-9,223,372,036,854,775,808 -> 9,223,372,036,854,775,807）

无符号整数：
uint8（0 -> 255）
uint16（0 -> 65,535）
uint32（0 -> 4,294,967,295）
uint64（0 -> 18,446,744,073,709,551,615）

浮点型（IEEE-754 标准）：
float32（+- 1e-45 -> +- 3.4 * 1e38）
float64（+- 5 1e-324 -> 107 1e308）
```

- 位运算：`&、|、^、&^(位清除：将指定位置上的值设置为 0)`
- 一元运算符：`<<、>>`
- 逻辑运算符：`==、!=、<、<=、>、>=`
- 算术运算符：`+、-、*、/、%`

```
优先级     运算符
 7         ^ !
 6         * / % << >> & &^
 5         + - | ^
 4         == != < <= >= >
 3         <-
 2         &&
 1         ||
```

- 类型别名：`type newType orgType`，如 `type AGE int`


# 3、变量、常量、指针
## 3.1 变量
- 声明变量的一般形式是使用 `var` 关键字：`var identifier type`。
- 为什么将变量类型放到变量名后面：避免像 C 语言中那样含糊不清的声明形式，例如：`int* a, b`。
- 当一个变量被声明之后，系统自动赋予它该类型的零值：`int` 为 0，`float` 为 0.0，`bool` 为 false，`string` 为空字符串，指针为 `nil`。

```go
var a int = 1

// Go 编译器可以根据变量的值来自动推断其类型，在编译时经完成推断过程
var b = 15
var c = false

// 在函数体内声明局部变量时，可使用简短声明语法 :=，不可以用于全局变量的声明与赋值
d := true

// 同一类型的多个变量可以声明在同一行
var e, f int
d, e, f = false, 1, 2

// 多个变量使用 := 声明并初始化
g, h := "abc", false

// 交换2个变量的值
e, f = f, e
```

- 值类型和引用类型：
    - `int`、`float`、`bool`、`string`、数组、结构体属于值类型
	- 指针、`slice`、`map`、`channel` 属于引用类型

## 3.2 常量
- 常量使用关键字 `const` 定义，用于存储不会改变的数据。常量的定义格式：`const identifier [type] = value`

```go
const b string = "abc"  // 显式类型定义
const b = "abc"         // 隐式类型定义
```

- 常量还可以用作枚举：

```go
const (
    Unknown = 0
    Female = 1
    Male = 2
)
```

- `iota` 使用方法：

```go
// 第一个 iota 等于 0，每当 iota 在新的一行被使用时，它的值都会自动加 1，
// 并且没有赋值的常量默认会应用上一行的赋值表达式：
const (
    a = iota    // a = 0
    b = iota    // b = 1
    c = iota    // c = 2
)

// 赋值一个常量时，之后没赋值的常量都会应用上一行的赋值表达式
const (
    a = iota  // a = 0
    b         // b = 1
    c         // c = 2
    d = 5     // d = 5
    e         // e = 5
)

// 赋值两个常量，iota 只会增长一次，而不会因为使用了两次就增长两次
const (
    Apple, Banana = iota + 1, iota + 2 // Apple=1 Banana=2
    Cherimoya, Durian                  // Cherimoya=2 Durian=3
    Elderberry, Fig                    // Elderberry=3, Fig=4
)

const (
    _ = iota                       // 使用 _ 忽略不需要的 iota
    KB = 1 << (10 * iota)          // 1 << (10*1)
    MB                             // 1 << (10*2)
    GB                             // 1 << (10*3)
    TB                             // 1 << (10*4)
)
```

# 4、控制结构
## 4.1 if-else 结构
```go
a, b := 1, 2
if a > b {
	fmt.Println("a > b")
} else if a < b {
	fmt.Println("a < b")
} else {
	fmt.Println("a == b")
}
```
- if 和 else 之后的 `{` 必须和关键字同一行，否则编译会报错：`syntax error: unexpected newline, expecting { after if clause`

## 4.2 switch结构
```go
// 第一种形式
switch variable {
	case value1:
		fmt.Println("case value1")	// 这里没有 break
	case value2:
		fmt.Println("case value2")
	default:
		fmt.Println("default")
}

// 第二种形式，case 中进行条件判断
switch {
    case i < 0:
        f1()
    case i == 0:
        f2()
    case i > 0:
        f3()
}

// 第三种形式，包含一个初始化语句
switch result := calculate(); {
    case result < 0:
        ...
    case result > 0:
        ...
    default:
        ...
}
```
- 变量 variable 可以是任何类型，而 value1 和 value2 则可以是同类型的任意值。类型不被局限于常量或整数，但必须是相同的类型；或者最终结果为相同类型的表达式。前花括号 { 必须和 switch 关键字在同一行。
- 如果在执行完每个分支的代码后，还希望继续执行后续分支的代码，可以使用 `fallthrough` 关键字来达到目的。

```go
switch i {
    case 0: fallthrough
    case 1:
        f() // 当 i == 0 时函数也会被调用
}
```

## 4.3 for 结构
```go
// 基本形式
for i := 0; i < 5; i++ {
    fmt.Printf("This is the %d iteration\n", i)
}

// 基于条件判断的迭代，类似于其他语言的 while
var i int = 5
for i >= 0 {
	i = i - 1
	fmt.Printf("The variable i is now: %d\n", i)
}

// 无限循环
for {
	// do something
	// 需要退出循环，用 break
}

// for-range 结构

```


1、go基本语法，常用容器：数组，slice，map，（ 第2、4章和文档）
